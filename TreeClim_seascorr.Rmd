---
title: "Explore treeclim/Seascorr"
output: html_notebook
---

[June 4, 2021] This is trial run of function Seascorr from package treeclim on
monthly climate data and a standard chronology from the Lake Tahoe Basin.

Seascorr requires input of monthly data for two climate variables (a primary and
a secondary), as well as an annual tree-ring time series. This notebook loads
that data as an RData file that you should have previously generated by script SeasCorrPrep1.R. 

Readings, as well as DISCO lectures, describe program Seascorr. Seascorr was written originally
in Mablab, and later adapted in a reduced form for R and included in the R-script TreeClim.
TreeClim_seascorr.Rmd is a subset of code extracted from TreeClim, commented, and converted to
an R markdown file (Rmd) for ease of use in DISCO.

Tailoring next chunk for your data.  
Your filename may differ from 'SeascorrTahoeInput.RData'

Prepare workspace, load libraries, and load your prepared seascorr input file
```{r}
rm(list=ls())
library(treeclim)

load ('SeascorrTahoeInput.RData')
```


### What is seascorr? (see the lecture and read  the paper)

Tailoring next chunk for your data.  
Settings in the "sc <-" statement should match series labels in your input file, and desired seasonal
settings for the analysis. For example, for the sample data:
  'P' and "T' are the labels for the primary and secondary climate data
  "Complete = 9" specifies that the ending month of tree-ring is set to September (9th of 12 months)
  "c(1, 3, 12)" specifies you want summaries for seasons of length 1, 3 and 12 months
  "primary = 1, secondary = 2" specifies that you want your first input climate variable (P) to be
    primary and the second (T) to be secondary.
  "ci = 0.05 specifies a 95% significane threshold (p-value 0.05)

Run seacorr for three monthly groupings with September as the end of the growth year. 
```{r}
#sc <- seascorr(A,X)
sc <- seascorr(A,X,var_names =c('P','T'), timespan = NULL, complete = 9,
season_lengths = c(1, 3, 12), primary = 1, secondary = 2, ci = 0.05)
#sc <- seascorr(muc_fake,muc_clim)
sc
plot(sc)
```
Seascorr give correlations for the primary climate variable and partial correlations for the secondary  climate variable. Reverse those, to check the Pearson correlaiton with termperature 
Tailoring next chunk for your data: see tailoring for previous chunk. Differnece here is in reversal of primary and secondary.

As described in notes, Pearson r is used to summarize relationship of tree-ring variable with primary climate variable and partical correlations (controlling for primary climate variable) are used to summarize relationship with secondary climate variable.
```{r}

sc <- seascorr(A,X,var_names =c('P','T'), timespan = NULL, complete = 9,
season_lengths = c(1, 3, 12), primary = 2, secondary = 1, ci = 0.05)
sc
plot(sc)
```



Repeat with P primary and T secondary, but change the monthly groupings 
Tailoring next chunk for your data: change settings as needed  (see above)
```{r}

sc <- seascorr(A,X,var_names =c('P','T'), timespan = NULL, complete = 10,
season_lengths = c(1, 4, 6), primary = 1, secondary = 2, ci = 0.05)
sc
plot(sc)
```

